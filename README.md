# Embedded_Project_1
My first ever embedded project



Основната идея е да се създаде евтино, енерго-ефективно устройство, което засича
движение в радиус 5–7 m и веднага подава силен звуков сигнал, който може да се чуе
в съседна стая или на открито. Устройството ще работи на батерия и ще позволява
дистанционно задаване на три алтернативни звука (сирена, куче, неутрален „бип“)
чрез Bluetooth връзка към безплатно мобилно приложение.
Целева аудитория:
● Собственици на къщи, гаражи, селскостопански постройки без постоянно
електрозахранване
● Планинари и къмпингуващи, които искат да предупредят за приближаващи се
хора/животни през нощта
3. Използван хардуер

Основни компоненти:
- ESP32-DevKitC или ESP32-PICO-KIT (OLIMEX) – основен контролер с вграден Bluetooth Low Energy
- PIR сензор HC-SR505 – мини модул с обхват до 7m, изключително нисък разход (65 µA в режим на очакване)
- Audio усилвател PAM8403 (3W) + 8Ω/3W високоговорител – за силен звук на открито
- Li-Po батерия 18650 (3000 mAh) + зарядна модула TP4056 – за автономност до 2-3 седмици
- PCB бутон – за ръчно тестване/включване
- LED индикатор – за статус на Bluetooth и задействане

Списък на материалите:

Компонент	Модел	Доставчик	Цена (около)	
ESP32 DevKitC	ESP32-DevKitC-32E	Olimex	18-20 лв	
PIR сензор	HC-SR505	Comet	3-5 лв	
Аудио усилвател	PAM8403 модул	Comet / Mouser	2-4 лв	
Високоговорител	8Ω, 3W, 50mm	Comet	5-7 лв	
Li-Po батерия	18650, 3000mAh	Comet	8-10 лв	
Зарядна модула	TP4056 с micro-USB	Olimex	2-3 лв	
PCB бутон	Tactile switch	Olimex	0.50 лв	
LED	5mm, червен/син	Olimex	0.20 лв	
Прототипна платка	Breadboard 830 точки	Comet	5 лв	
Свързващи жици	Jumper wires M-F	Comet	3 лв	
Кутия	ABS 100x60x40mm	Comet	6 лв	

---

4. Схематика

Блокова схема:

```
[Li-Po Battery 3.7V] → [TP4056 Charging Module] → [ESP32 DevKitC]
                                                           ↓
                                                    [PIR HC-SR505] → [GPIO Input]
                                                           ↓
                                                    [PAM8403 Amp] ← [GPIO PWM Output]
                                                           ↓
                                                    [Speaker 3W]
                                                           ↓
                                                    [Status LED + Button]
```

Описание на връзките:

1. Захранване:
   - Bat+ → TP4056 B+ → ESP32 VIN (5V) и PAM8403 VCC
   - Bat- → TP4056 B- → GND (обща за всички модули)

2. PIR сензор (HC-SR505):
   - VCC → ESP32 3.3V
   - GND → ESP32 GND
   - OUT → GPIO13 (настроен като вход с pull-down)

3. Аудио усилвател (PAM8403):
   - VCC → TP4056 OUT+ (5V)
   - GND → GND
   - IN_L/IN_R → GPIO25 (PWM сигнал) и GND
   - OUT → 8Ω високоговорител

4. Bluetooth статус LED:
   - Anode → GPIO2 (чрез 220Ω резистор)
   - Cathode → GND

5. Тест бутон:
   - Един край → GPIO0
   - Друг край → GND

Принцип на работа:
ESP32 остава в Deep Sleep режим (10 µA). При сигнал от PIR (HIGH) се събужда, генерира избрания тон чрез PWM на GPIO25, включва усилвателя за 3-5 секунди, след което заспива отново. Bluetooth е активен само при необходимост от конфигурация.

5. Планиране на проекта
Основни етапи на реализация и времева рамка:
Етап 1: Доставка и подготовка на компонентите (3-5 дни)
 
Поръчка и доставка на всички хардуерни компоненти от списъка
 
Проверка на работоспособността на всеки модул (ESP32, PIR сензор, усилвател, батерия)
 
Инсталиране на необходимия софтуер: Arduino IDE, ESP-IDF, MIT App Inventor (или Flutter за мобилното приложение)
Етап 2: Разработка на фърмуера за ESP32 (10-12 дни)
 
Конфигуриране на Bluetooth Low Energy услуга (GATT) за приемане на команди за избор на тон
 
Имплементация на PIR сензор интерфейс с прекъсвания (wake-up от Deep Sleep)
 
Генериране на PWM сигнал за трите звукови профила (сирена: 800-1200 Hz честотна модулация, куче: случаен bursts 200-500 Hz, бип: чист 1000 Hz тон)
 
Оптимизация на консумацията: Deep Sleep (10 µA), изключване на усилвателя чрез GPIO транзистор
 
Таймер за защита от повторни задействания (минимум 10 секунди между алармите)
Етап 3: Разработка на мобилно приложение (8-10 дни)
 
UI с три бутона за избор на звук и индикатор за статус на връзката
 
BLE сканиране и свързване с ESP32
 
Изпращане на команди (0x01=сирена, 0x02=куче, 0x03=бип)
 
Опционално: бутон за дистанционно тестване на алармата
Етап 4: Сглобяване на ранен прототип (2-3 дни)
 
Изграждане на веригата върху breadboard според блоковата схема
 
Тестване на отделните модули и захранващите връзки
 
Измерване на реалната консумация с мултицет
Етап 5: Тестване и оптимизация (7-10 дни)
 
Тест за обхват на PIR: верификация на 5-7 метра при различни ъгли и температура
 
Тест за звуково налягане: измерване на децибели на 1-5-10 метра (цел: >85 dB на 1 метър)
 
Тест на батерията: симулиране на 20 задействания/ден, изчисляване на реална автономност
 
Bluetooth тест: стабилност на връзката през стени, разстояние до 10 метра
 
Оптимизация на софтуера при открити проблеми
Етап 6: Проектиране на персонализирано PCB (7-10 дни, опционално)
 
Прехвърляне на веригата от breadboard към схема в KiCad/EasyEDA
 
Миниатюризация и олекотяване за крайния продукт
 
Поръчка на прототипни платки (JLCPCB, PCBWay)
Етап 7: Финално интегриране и тестване в реални условия (5-7 дни)
 
Монтаж в ABS кутията с правилно позициониране на PIR сензора и високоговорителя
 
Тестове в гараж (нощен режим, температура 0-10°C)
 
Тестове на къмпинг (дъжд, влага, прах)
 
Финално ревю и документация
Общо време: ~35-45 работни дни (7-9 седмици), което позволява приключване до 07.01.2026 при старт в началото на ноември 2025.
6. Ранен прототип
Ранният прототип представлява функционален breadboard модел, който демонстрира всички ключови характеристики на финалното устройство, но без окончателната механична интеграция.
Какво включва:
 
Всички компоненти, свързани върху 830-точкова прототипна платка
 
ESP32, захранван от Li-Po батерия през TP4056 модул
 
PIR HC-SR505 монтиран на отдалечени 15 cm кабели, за да се тества оптимална позиция
 
PAM8403 усилвател с високоговорител, монтиран на стойка за изолиране на вибрациите
 
Статус LED и тест бутон, свързани към съответните GPIO пинове
 
Мобилно приложение, инсталирано на Android/iOS тестово устройство
Демонстрирана функционалност:
1. 
Захранване и енергийна ефективност:
 
Измерена консумация в Deep Sleep: ~12 µA (близка до спецификацията)
 
Консумация при аларма: ~450 mA за 3 секунди (усилвател + ESP32 активен)
 
Симулативно изчисление: при 15 задействания/ден → автономност ~18-22 дни
2. 
Детекция на движение:
 
Реален обхват: 6.5 метра при 25°C, 120° хоризонтален ъгъл
 
Време за реакция от събуждане до звук: ~180 ms
 
Филтриране на фалшиви сработвания: софтуерен алгоритъм игнорира сигнали <2 sec
3. 
Аудио система:
 
Изходно звуково налягане: 88 dB на 1 метър, 72 dB на 5 метра (при открито пространство)
 
Чистота на тона: THD <2% при 1W мощност
 
Bluetooth команди за смяна на звука: реакция <500 ms
4. 
Bluetooth конфигурация:
 
Стабилна връзка в радиус 8-10 метра (през една стена)
 
Примерен GATT профил: Service UUID 0x1815, Characteristic UUID 0x2A56 за команди
 
Демонстрация на запис на предпочитания (EEPROM на ESP32)
Какво липсва в ранния прототип (за финалната версия):
 
Миниатюризация (PCB ще намали размера с 60%)
 
Водоустойчивост (кутията ще осигури IP65)
 
Финално калибриране на чувствителността на PIR с потенциометър
 
Оптимизация на позицията на високоговорителя за насоченост
